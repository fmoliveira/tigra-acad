@model Tigra.Models.MyProfileModel

@{
	Layout = null;
}

<div class="modal-header">
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	<h4 class="modal-title">Meu Perfil</h4>
</div>
<div class="modal-body">
	<p>Preencha o seu perfil para que seus colegas saibam um pouco mais sobre você!</p>

	<div class="row">
		<div class="col-sm-4">
			<p>
				<label class="control-label">Foto de perfil:</label>
				<img src="@Url.Content("~/Scripts/holder.js/160x200")" class="img-thumbnail" alt="Foto de perfil.">
			</p>
			<button class="btn btn-primary btn-block" style="width:160px" type="button" data-action="UploadPicture">Alterar</button>
			<button class="btn btn-danger btn-block" style="width:160px" type="button" data-action="RemovePicture">Remover</button>
		</div>
		<div class="col-sm-8">
			<p>
				<label class="control-label">Nome:</label>
				<input type="text" class="form-control" data-field="fullname" value="@Html.Raw(Model.FullName)" placeholder="Digite seu nome e sobrenome" autofocus>
			</p>
					
			<p>
				<label class="control-label">Data de nascimento:</label>
				<input type="text" class="form-control" data-field="birthdate" placeholder="Informe sua data de nascimento">
			</p>
					
			<p>
				<label class="control-label">Localização:</label>
				<input type="text" class="form-control" data-field="location" placeholder="Em que cidade você mora?">
			</p>
					
			<p>
				<label class="control-label">Auto biografia:</label>
				<textarea class="form-control" rows="3" data-field="biography" placeholder="Escreva um pouco sobre você..."></textarea>
			</p>
		</div>
	</div>
</div>
<div class="modal-footer">
	<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
	<button type="button" class="btn btn-primary" data-action="SaveProfile">Salvar</button>
</div>

<script type="text/javascript">
	$('button[data-action!=""]').click(function () {
		var $action = $(this).data('action');

		if ($action == "SaveProfile") {
			/* Make post URI and get login data. */
			var $fullname = $('input[data-field="fullname"]');
			var $uri = $('body').data('api') + $action;
			var $data = JSON.stringify({ "FullName": $fullname.val() });

			/* Post login data. */
			$.ajax({
				url: $uri,
				type: 'POST',
				dataType: 'json',
				data: $data,
				contentType: 'application/json; charset=utf-8',
				complete: function (x, y, z) {
					switch (x.status) {
						case 200:
							location.reload();
							break;

						case 500:
							alert('Erro no servidor!');
							break;

						default:
							alert('Erro inesperado (código ' + x.status + ')!');
							break;
					}
				}
			});
		}
	});
</script>